<% provide(:title, 'Reservetion') %>

  <h1>Scheduler</h1>

  <div class="row">
    <div class='col-sm-6'>
      <%=form_tag('/reservation', method: :get) do%>
          <div class="form-group">
            <div class='input-group date' id='datetimepicker1'>
                <input type='text' class="form-control" name="start_date" data-date-format="YYYY-MM-DD"/>
                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
            <%= submit_tag "Select Date" %>
          </div>
          
      <% end %>
    </div>
  </div>
  
  <div class = "row">
    <div class="col-sm-4">
      <div class="panel panel-default">
        <div class="panel-body">
          <span class="glyphicon glyphicon-lock"> : Reserved Timeslots</span>
        </div>
      </div>
    </div>
  </div>

  <div class = "row">
    <div class = "col-lg-12">    
      <section class = "panel ">
        <%if @date == Date.today.to_s %>
          <header class="panel-heading"> Reservation table for the next 24 hours</header>
        <%else%>
          <header class="panel-heading"> Reservation table for <%=@date%></header>
        <%end%>
        <div class = "panel-body">

          <div class="table-responsive">

            <%=form_tag make_reservation_path do%>
              <%= select_tag(:user_slice, options_for_select(@user_slices)) %>

              <table class="table table-hover table-bordered">

                <tr>
                  <%@reservation_table[0].each_key do |key|%>
                    <td><%=key%></td>
                  <%end%>
                </tr>

                <%@reservation_table.each do |iterate|%>
                  <tr title = "<%=iterate.values[0]%>">
                    <%iterate.each do |key, value|%>  
                      <%if key == "Name"%>
                        <td>
                          <%=value%>                  
                        </td>
                      <%else%>  
                        <%if value == 1%>        
                          <td>
                            <span class = "glyphicon glyphicon-lock"></span>                             
                          </td>
                        <%else%>
                          <td>
                            <%timh = iterate.values[0]+"/"+key %>
                            <%=check_box_tag "reservations[]",iterate.values[0]+"/"+key,false, :class => "regular-checkbox big-checkbox",:id => timh%>
                            <label for="<%=timh%>"></label>                      
                          </td>
                        <%end%>
                      <%end%>
                    <%end%>
                  </tr>
                <%end%>
              </table>
              <%= submit_tag "Make reservations" %>
            <% end %>
          </div>
        </div>
      </section>
    </div>
  </div>


<script type="text/javascript">
              $(function () {
                var today = moment();
                  $('#datetimepicker1').datetimepicker({
                    minDate: today,
                    pickTime: false
                  });
              });
          </script>